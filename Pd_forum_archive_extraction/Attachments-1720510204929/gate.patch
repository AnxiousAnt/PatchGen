6c6,8
<     float     x_state;
---
>     int       num_outlets;
>     void      *x_curr_outlet;
>     void      *x_outlet[10];
13,14c15,16
<     if(x->x_state != 0)
< 	outlet_bang(x->x_obj.ob_outlet);
---
>     if(x->x_curr_outlet)
> 	outlet_bang(x->x_curr_outlet);
19,20c21,22
<     if(x->x_state != 0)
< 	outlet_pointer(x->x_obj.ob_outlet, gp);
---
>     if(x->x_curr_outlet)
> 	outlet_pointer(x->x_curr_outlet, gp);
25,26c27,28
<     if(x->x_state != 0)
< 	outlet_float(x->x_obj.ob_outlet, f);
---
>     if(x->x_curr_outlet)
> 	outlet_float(x->x_curr_outlet, f);
31,32c33,34
<     if(x->x_state != 0)
< 	outlet_symbol(x->x_obj.ob_outlet, s);
---
>     if(x->x_curr_outlet)
> 	outlet_symbol(x->x_curr_outlet, s);
37,38c39,40
<     if(x->x_state != 0)
< 	outlet_list(x->x_obj.ob_outlet, s, argc, argv);
---
>     if(x->x_curr_outlet)
> 	outlet_list(x->x_curr_outlet, s, argc, argv);
43,44c45,46
<     if(x->x_state != 0)
< 	outlet_anything(x->x_obj.ob_outlet, s, argc, argv);
---
>     if(x->x_curr_outlet)
> 	outlet_anything(x->x_curr_outlet, s, argc, argv);
47c49
< static void *gate_new(t_floatarg f)
---
> static void gate_state(t_gate *x, t_floatarg f)
48a51,57
>   x->x_curr_outlet = (f < 1) ? 0 : (f >= x->num_outlets) ? x->x_outlet[x->num_outlets-1] : x->x_outlet[(int) f-1];
> }
> 
> static void *gate_new(t_floatarg f1, t_floatarg f2)
> {
>     int i;
> 
50,52c59,81
<     floatinlet_new(&x->x_obj, &x->x_state);
<     outlet_new(&x->x_obj, 0);
<     x->x_state = (f==0.0)?0:1;
---
>     inlet_new(&x->x_obj, &x->x_obj.ob_pd, gensym("float"), gensym(""));
>     x->num_outlets = (f1<=1) ? 1 : (f1>=10) ? 10 : (int) f1;
>     for (i = 0; i < x->num_outlets; i++)
>       x->x_outlet[i] = outlet_new(&x->x_obj, 0);
>     
>       if (f2 < 0) {
>         x->x_curr_outlet = 0;
>       }
>       else {
>         if (f2 == 0) {
>           if (f1 < 1)
>             x->x_curr_outlet = 0;
>           else
>             x->x_curr_outlet = x->x_outlet[x->num_outlets-1];
>         }
>         else {
>           if (f2 >= x->num_outlets)
>             x->x_curr_outlet = x->x_outlet[x->num_outlets-1];
>           else 
>             x->x_curr_outlet = x->x_outlet[(int)f2 - 1];
>         }
>       }
>     post("gate_new: %d %d", (int)f1, (int)f2);
59c88
<     	sizeof(t_gate), 0, A_DEFFLOAT, 0);
---
>     	sizeof(t_gate), 0, A_DEFFLOAT, A_DEFFLOAT, 0);
65a95
>     class_addmethod  (gate_class, (t_method)gate_state, gensym(""), A_FLOAT, 0);
