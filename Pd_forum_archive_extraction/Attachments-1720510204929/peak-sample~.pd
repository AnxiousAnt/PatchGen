#N canvas 49 228 530 359 10;
#X obj 92 48 sig~ 1;
#X obj 92 75 lrshift~ -1;
#X obj 41 47 inlet~;
#N canvas 83 536 230 209 \$0-max 0;
#X obj 40 40 inlet~;
#X obj 141 41 block~ 1;
#X obj 91 41 inlet~;
#X obj 40 117 max~;
#X obj 50 146 delwrite~ \$0-max;
#X obj 106 67 delread~ \$0-max 0;
#X obj 91 93 *~;
#X obj 40 173 outlet~;
#X connect 0 0 3 0;
#X connect 2 0 6 0;
#X connect 3 0 4 0;
#X connect 3 0 7 0;
#X connect 5 0 6 1;
#X connect 6 0 3 1;
#X restore 41 122 pd \$0-max;
#N canvas 229 567 230 209 \$0-min 0;
#X obj 40 40 inlet~;
#X obj 141 41 block~ 1;
#X obj 91 41 inlet~;
#X obj 91 93 *~;
#X obj 40 173 outlet~;
#X obj 50 146 delwrite~ \$0-min;
#X obj 106 67 delread~ \$0-min 0;
#X obj 40 117 min~;
#X connect 0 0 7 0;
#X connect 2 0 3 0;
#X connect 3 0 7 1;
#X connect 6 0 3 1;
#X connect 7 0 4 0;
#X connect 7 0 5 0;
#X restore 110 122 pd \$0-min;
#N canvas 0 22 450 300 \$0-peaktable 0;
#X obj 85 89 tabsend~ \$0-table;
#X obj 85 64 inlet~;
#X obj 79 226 outlet~;
#X obj 189 58 table \$0-table;
#X connect 1 0 0 0;
#X restore 41 252 pd \$0-peaktable;
#N canvas 0 22 450 300 \$0-tabread 0;
#X obj 130 163 tabread~ \$0-table;
#X obj 45 61 inlet~;
#X obj 130 138 sig~;
#X obj 130 91 r \$0-block;
#X obj 130 115 - 1;
#X obj 130 187 outlet~;
#X connect 0 0 5 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 2 0;
#X restore 41 277 pd \$0-tabread;
#X obj 321 92 block~;
#X obj 216 95 loadbang;
#X obj 206 127 f \$1;
#X obj 275 193 s \$0-block;
#N canvas 7 232 608 400 \$0-peak 0;
#X obj 54 73 inlet~;
#X obj 183 74 inlet~;
#X text 59 33 max;
#X text 183 34 min;
#X obj 128 292 outlet~;
#X obj 105 104 abs~;
#X obj 84 129 max~;
#X obj 69 156 /~;
#X obj 54 254 *~;
#X obj 168 253 *~;
#X text 195 290 <- send out the max or min peak \, deferring to max
in case of a tie;
#N canvas 3 312 281 255 \$0-equals_one? 0;
#X obj 119 35 inlet~;
#X obj 49 187 outlet~;
#X obj 119 187 outlet~;
#X obj 119 62 -~ 1;
#X obj 119 90 /~;
#X obj 49 136 *~ -1;
#X obj 49 162 +~ 1;
#X connect 0 0 3 0;
#X connect 3 0 4 0;
#X connect 3 0 4 1;
#X connect 4 0 5 0;
#X connect 4 0 2 0;
#X connect 5 0 6 0;
#X connect 6 0 1 0;
#X restore 69 189 pd \$0-equals_one?;
#X text 304 40 output signed peak;
#X text 208 186 <- toggle for whether to use max or min;
#X connect 0 0 6 0;
#X connect 0 0 7 0;
#X connect 0 0 8 0;
#X connect 1 0 5 0;
#X connect 1 0 9 1;
#X connect 5 0 6 1;
#X connect 6 0 7 1;
#X connect 7 0 11 0;
#X connect 8 0 4 0;
#X connect 9 0 4 0;
#X connect 11 0 8 1;
#X connect 11 1 9 0;
#X restore 41 222 pd \$0-peak;
#X obj 321 46 r \$0-block;
#X msg 321 68 set \$1;
#X obj 206 47 inlet;
#X obj 206 68 route set;
#X msg 245 217 resize \$1;
#X msg 206 176 64;
#X obj 206 151 moses 2;
#X obj 245 241 s \$0-table;
#X obj 41 304 outlet~;
#X text 134 277 <- Get last (peak) sample in the block. If [lrshift~]
were settable \, this could be done with [lrshift~] and [samphold~]
;
#X text 111 222 <- find signed peak;
#X connect 0 0 1 0;
#X connect 1 0 3 1;
#X connect 1 0 4 1;
#X connect 2 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 11 0;
#X connect 4 0 11 1;
#X connect 5 0 6 0;
#X connect 6 0 20 0;
#X connect 8 0 9 0;
#X connect 9 0 18 0;
#X connect 11 0 5 0;
#X connect 12 0 13 0;
#X connect 13 0 7 0;
#X connect 14 0 15 0;
#X connect 15 0 9 0;
#X connect 16 0 19 0;
#X connect 17 0 10 0;
#X connect 17 0 16 0;
#X connect 18 0 17 0;
#X connect 18 1 10 0;
#X connect 18 1 16 0;
